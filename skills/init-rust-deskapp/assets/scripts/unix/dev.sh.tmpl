#!/bin/bash
# {{PROJECT_NAME}} - Development Mode
# Builds frontend then runs Tauri desktop app

set -e

# Load cargo environment if exists
if [ -f "$HOME/.cargo/env" ]; then
    source "$HOME/.cargo/env"
fi

cd "$(dirname "$0")/../.."

echo "=== {{PROJECT_NAME}} Dev Mode ==="

# Check if node_modules exists
if [ ! -d "web/node_modules" ]; then
    echo "Installing dependencies..."
    cd web && npm install && cd ..
fi

# [1] Build frontend
echo "[1] Building frontend..."
cd web && npm run build && cd ..

# [2] Run Tauri app (loads from web/dist)
echo "[2] Starting Tauri app..."
cd src-tauri && cargo run
