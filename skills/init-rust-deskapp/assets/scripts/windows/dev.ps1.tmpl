# {{PROJECT_NAME}} - Development Mode
# Builds frontend then runs Tauri desktop app

$ErrorActionPreference = "Stop"

Push-Location $PSScriptRoot/../..

try {
    Write-Host "=== {{PROJECT_NAME}} Dev Mode ===" -ForegroundColor Cyan

    # Check if node_modules exists
    if (-not (Test-Path "web/node_modules")) {
        Write-Host "Installing dependencies..." -ForegroundColor Yellow
        Push-Location web
        npm install
        Pop-Location
    }

    # [1] Build frontend
    Write-Host "[1] Building frontend..." -ForegroundColor Yellow
    Push-Location web
    npm run build
    Pop-Location

    # [2] Run Tauri app (loads from web/dist)
    Write-Host "[2] Starting Tauri app..." -ForegroundColor Yellow
    Push-Location src-tauri
    cargo run
    Pop-Location
}
finally {
    Pop-Location
}
